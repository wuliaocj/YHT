# API文档

本文档整理了益禾堂奶茶点餐系统的后端API接口信息，包括所有Controller的端点、参数详情和示例。

## AddressController

**基础路径**: `/api/address`

### GET /list/{userId}
获取用户地址列表

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |

### POST /save
保存地址

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| address | Address | 是 | 地址对象 | 见下表 |

**Address对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 地址ID（新增时可为空） | null |
| userId | Integer | 是 | 用户ID | 1001 |
| consignee | String | 是 | 收货人姓名 | 张三 |
| phone | String | 是 | 联系电话 | 13800138000 |
| province | String | 是 | 省份 | 北京市 |
| city | String | 是 | 城市 | 北京市 |
| district | String | 是 | 区县 | 朝阳区 |
| detailAddress | String | 是 | 详细地址 | 建国门外大街1号 |
| postalCode | String | 否 | 邮政编码 | 100022 |
| isDefault | Integer | 否 | 是否默认地址（1=是，0=否） | 1 |
| status | Integer | 否 | 状态（1=启用，0=禁用） | 1 |

**完整示例**:
```json
{
  "userId": 1001,
  "consignee": "张三",
  "phone": "13800138000",
  "province": "北京市",
  "city": "北京市",
  "district": "朝阳区",
  "detailAddress": "建国门外大街1号",
  "postalCode": "100022",
  "isDefault": 1,
  "status": 1
}
```

### POST /delete/{id}
删除地址

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 是 | 地址ID | 1 |

## AdminController

**基础路径**: `/api/admin`

### POST /login
管理员登录

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| request | Map<String, String> | 是 | 登录请求体 | 见下表 |

**Map字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| username | String | 是 | 管理员用户名 | admin |
| password | String | 是 | 管理员密码 | 123456 |

**完整示例**:
```json
{
  "username": "admin",
  "password": "123456"
}
```

### GET /current
获取当前管理员信息

**参数**: 无

### GET /user/list
获取用户列表

**参数**: 无

### GET /order/list
获取订单列表

**参数**: 无

## BannerController

**基础路径**: `/api/admin/banner`

### GET /list
获取轮播图列表

**参数**: 无

### POST /save
保存轮播图

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| banner | Banner | 是 | 轮播图对象 | 见下表 |

**Banner对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 轮播图ID（新增时可为空） | null |
| title | String | 是 | 标题 | 新品上市 |
| imageUrl | String | 是 | 图片URL | https://example.com/banner.jpg |
| linkType | Integer | 是 | 链接类型 | 1 |
| linkValue | String | 否 | 链接值 | product/1 |
| sortOrder | Integer | 否 | 排序序号 | 1 |
| status | Integer | 否 | 状态（1=启用，0=禁用） | 1 |
| startTime | LocalDateTime | 否 | 开始时间 | 2026-01-26T00:00:00 |
| endTime | LocalDateTime | 否 | 结束时间 | 2026-12-31T23:59:59 |

**完整示例**:
```json
{
  "title": "新品上市",
  "imageUrl": "https://example.com/banner.jpg",
  "linkType": 1,
  "linkValue": "product/1",
  "sortOrder": 1,
  "status": 1,
  "startTime": "2026-01-26T00:00:00",
  "endTime": "2026-12-31T23:59:59"
}
```

### POST /delete/{id}
删除轮播图

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 是 | 轮播图ID | 1 |

## CartController

**基础路径**: `/api/cart`

### GET /{userId}
获取用户购物车

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |

### POST /add
添加商品到购物车

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| addCartVO | AddCartVO | 是 | 添加购物车对象 | 见下表 |

**AddCartVO对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |
| productId | Integer | 是 | 商品ID | 10 |
| quantity | Integer | 是 | 购买数量（最小1） | 2 |
| cupSpecId | Long | 是 | 杯型规格ID | 20 |
| tasteSpecId | Long | 是 | 口味规格ID | 23 |
| temperatureSpecId | Long | 是 | 温度规格ID | 25 |
| toppingSpecIds | List<Long> | 否 | 小料规格ID列表 | [40, 41] |
| isSelected | Integer | 否 | 是否选中（1=选中，0=未选中，默认1） | 1 |

**完整示例**:
```json
{
  "userId": 1001,
  "productId": 10,
  "quantity": 2,
  "cupSpecId": 20,
  "tasteSpecId": 23,
  "temperatureSpecId": 25,
  "toppingSpecIds": [40, 41],
  "isSelected": 1
}
```

### POST /update
更新购物车项

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| cartId | Integer | 是 | 购物车ID | 1 |
| quantity | Integer | 是 | 购买数量 | 3 |
| selectedSpecs | String | 否 | 规格 | 规格1,规格2 |
| selected | Boolean | 否 | 是否选中 | true |

### POST /remove/{cartId}
移除购物车项

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| cartId | Integer | 是 | 购物车ID | 1 |

### POST /clear/{userId}
清空用户购物车

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |

## CategoryController

**基础路径**: `/api`

### GET /admin/category/list
获取分类列表

**参数**: 无

### POST /admin/category/save
保存分类

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| category | Category | 是 | 分类对象 | 见下表 |

**Category对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 分类ID（新增时可为空） | null |
| name | String | 是 | 分类名称 | 奶茶 |
| icon | String | 否 | 图标 | icon.png |
| description | String | 否 | 描述 | 各种口味的奶茶 |
| sortOrder | Integer | 否 | 排序序号 | 1 |
| status | Integer | 否 | 状态（1=启用，0=禁用） | 1 |

**完整示例**:
```json
{
  "name": "奶茶",
  "icon": "icon.png",
  "description": "各种口味的奶茶",
  "sortOrder": 1,
  "status": 1
}
```

### POST /admin/category/delete/{id}
删除分类

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 是 | 分类ID | 1 |

## CouponController

**基础路径**: `/api/admin/coupon`

### GET /list
获取优惠券列表

**参数**: 无

### POST /save
保存优惠券

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| coupon | Coupon | 是 | 优惠券对象 | 见下表 |

**Coupon对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 优惠券ID（新增时可为空） | null |
| name | String | 是 | 优惠券名称 | 新用户优惠券 |
| type | Integer | 是 | 优惠券类型 | 1 |
| value | BigDecimal | 是 | 优惠券面值 | 10.00 |
| minAmount | BigDecimal | 是 | 最低使用金额 | 50.00 |
| totalCount | Integer | 是 | 总数量 | 100 |
| remainingCount | Integer | 是 | 剩余数量 | 100 |
| limitPerUser | Integer | 是 | 每用户限领数量 | 1 |
| validityType | Integer | 是 | 有效期类型 | 1 |
| startTime | LocalDate | 否 | 开始时间（yyyy-MM-dd） | 2026-01-26 |
| endTime | LocalDate | 否 | 结束时间（yyyy-MM-dd） | 2026-12-31 |
| validDays | Integer | 否 | 有效天数 | 30 |
| applicableProducts | String | 否 | 适用商品 | 1,2,3 |
| applicableCategories | String | 否 | 适用分类 | 1,2 |
| status | Integer | 否 | 状态（1=启用，0=禁用） | 1 |

**完整示例**:
```json
{
  "name": "新用户优惠券",
  "type": 1,
  "value": 10.00,
  "minAmount": 50.00,
  "totalCount": 100,
  "remainingCount": 100,
  "limitPerUser": 1,
  "validityType": 1,
  "startTime": "2026-01-26",
  "endTime": "2026-12-31",
  "status": 1
}
```

### POST /delete/{id}
删除优惠券

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 是 | 优惠券ID | 1 |

## OrderController

**基础路径**: `/api/order`

### POST /create
创建订单

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |
| order | Order | 是 | 订单对象 | 见下表 |

**Order对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 订单ID（系统生成） | null |
| orderNo | String | 否 | 订单号（系统生成） | null |
| userId | Integer | 是 | 用户ID | 1001 |
| totalAmount | BigDecimal | 是 | 总金额 | 25.00 |
| discountAmount | BigDecimal | 否 | 优惠金额 | 5.00 |
| deliveryFee | BigDecimal | 否 | 配送费 | 3.00 |
| actualAmount | BigDecimal | 否 | 实际支付金额 | 23.00 |
| paymentMethod | Integer | 是 | 支付方式（1=微信，2=支付宝，3=现金） | 1 |
| paymentStatus | Integer | 否 | 支付状态 | 0 |
| orderStatus | Integer | 否 | 订单状态 | 0 |
| orderType | Integer | 是 | 订单类型（1=堂食，2=外卖） | 2 |
| takeCode | String | 否 | 取餐码 | A001 |
| userRemark | String | 否 | 用户备注 | 少糖 |
| adminRemark | String | 否 | 管理员备注 | null |

**完整示例**:
```json
{
  "userId": 1001,
  "totalAmount": 25.00,
  "discountAmount": 5.00,
  "deliveryFee": 3.00,
  "actualAmount": 23.00,
  "paymentMethod": 1,
  "orderType": 2,
  "userRemark": "少糖"
}
```

### GET /list/{userId}
获取用户订单列表

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |

### GET /{orderId}
获取订单详情

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| orderId | Integer | 是 | 订单ID | 1 |

### GET /admin/order/list
管理员获取订单列表（分页）

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| pageRequest | PageRequestVO | 否 | 分页请求对象 | 见下表 |

**PageRequestVO对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| pageNum | Integer | 否 | 页码（默认1） | 1 |
| pageSize | Integer | 否 | 每页大小（默认10） | 10 |
| orderBy | String | 否 | 排序字段 | createTime |
| orderDirection | String | 否 | 排序方向（asc/desc，默认desc） | desc |

**完整示例**:
```json
{
  "pageNum": 1,
  "pageSize": 10,
  "orderBy": "createTime",
  "orderDirection": "desc"
}
```

### POST /admin/order/update
管理员更新订单

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| request | Map<String, Object> | 是 | 更新请求体 | 见下表 |

**Map字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| orderId | Integer | 是 | 订单ID | 1 |
| status | Integer | 是 | 订单状态 | 2 |
| adminRemark | String | 否 | 管理员备注 | 订单已确认 |

**完整示例**:
```json
{
  "orderId": 1,
  "status": 2,
  "adminRemark": "订单已确认"
}
```

## PaymentController

**基础路径**: `/api/payment`

### POST /create
创建支付单

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| orderNo | String | 是 | 订单号 | ORD202601260001 |

### GET /status/{orderNo}
查询支付状态

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| orderNo | String | 是 | 订单号 | ORD202601260001 |

### POST /callback
支付回调

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| callbackData | Map<String, String> | 是 | 支付回调数据 | 见下表 |

**Map字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| return_code | String | 是 | 返回码 | SUCCESS |
| out_trade_no | String | 是 | 商户订单号 | ORD202601260001 |

**完整示例**:
```json
{
  "return_code": "SUCCESS",
  "out_trade_no": "ORD202601260001"
}
```

### POST /mock/success
模拟支付成功

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| orderNo | String | 是 | 订单号 | ORD202601260001 |

## ProductController

**基础路径**: `/api/product`

### GET /{id}
获取商品详情

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | long | 是 | 商品ID | 1 |

### POST /admin/add
添加商品

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| addProductVO | AddProductVO | 是 | 添加商品对象 | 见下表 |

**AddProductVO对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| name | String | 是 | 商品名称 | 珍珠奶茶 |
| categoryId | Integer | 是 | 分类ID | 1 |
| basePrice | Double | 是 | 基础价格 | 12.00 |
| originalPrice | Double | 是 | 原价 | 15.00 |
| sort_order | int | 否 | 排序序号（默认0） | 1 |
| mainImage | String | 是 | 商品主图 | milktea.jpg |
| description | String | 否 | 商品描述 | 经典珍珠奶茶 |
| detail | String | 否 | 商品详情 | 使用新鲜牛奶和优质珍珠制作 |
| status | Integer | 否 | 状态（1=启用，0=禁用，默认1） | 1 |
| isHot | Integer | 否 | 是否热门（1=是，0=否，默认1） | 1 |
| isNew | Integer | 否 | 是否新品（1=是，0=否，默认1） | 0 |
| isRecommend | Integer | 否 | 是否推荐（1=是，0=否，默认1） | 1 |
| cupTypeList | List<ProductSpecPrice> | 是 | 杯型规格列表 | [{"specName": "大杯", "price": 2.00}] |
| tasteList | List<ProductSpecPrice> | 是 | 口味规格列表 | [{"specName": "正常糖", "price": 0.00}] |
| temperatureList | List<ProductSpecPrice> | 是 | 温度规格列表 | [{"specName": "常温", "price": 0.00}] |
| toppingList | List<ProductSpecPrice> | 否 | 小料规格列表 | [{"specName": "珍珠", "price": 2.00}] |

**完整示例**:
```json
{
  "name": "珍珠奶茶",
  "categoryId": 1,
  "basePrice": 12.00,
  "originalPrice": 15.00,
  "mainImage": "milktea.jpg",
  "description": "经典珍珠奶茶",
  "cupTypeList": [{"specName": "大杯", "price": 2.00}],
  "tasteList": [{"specName": "正常糖", "price": 0.00}],
  "temperatureList": [{"specName": "常温", "price": 0.00}],
  "toppingList": [{"specName": "珍珠", "price": 2.00}]
}
```

### GET /admin/list
获取商品列表（管理员）

**参数**: 无

### POST /admin/update
更新商品

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| addProductVO | AddProductVO | 是 | 更新商品对象 | 同添加商品 |

### GET /user/list
获取商品列表（用户）

**参数**: 无

### POST /admin/delete/{id}
删除商品

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Long | 是 | 商品ID | 1 |

## PromotionController

**基础路径**: `/api/admin/promotion`

### GET /list
获取活动列表

**参数**: 无

### POST /save
保存活动

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| promotion | Promotion | 是 | 活动对象 | 见下表 |

**Promotion对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 否 | 活动ID（新增时可为空） | null |
| name | String | 是 | 活动名称 | 春节促销 |
| type | Integer | 是 | 活动类型 | 1 |
| description | String | 否 | 活动描述 | 春节期间全场8折 |
| ruleConfig | String | 否 | 规则配置 | {"discount": 0.8} |
| startTime | LocalDateTime | 是 | 开始时间 | 2026-02-01T00:00:00 |
| endTime | LocalDateTime | 是 | 结束时间 | 2026-02-15T23:59:59 |
| status | Integer | 否 | 状态（1=启用，0=禁用） | 1 |
| sortOrder | Integer | 否 | 排序序号 | 1 |

**完整示例**:
```json
{
  "name": "春节促销",
  "type": 1,
  "description": "春节期间全场8折",
  "ruleConfig": "{\"discount\": 0.8}",
  "startTime": "2026-02-01T00:00:00",
  "endTime": "2026-02-15T23:59:59",
  "status": 1,
  "sortOrder": 1
}
```

### POST /delete/{id}
删除活动

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| id | Integer | 是 | 活动ID | 1 |

## UploadController

**基础路径**: `/api/upload`

### POST /image
上传图片

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| files | MultipartFile[] | 是 | 上传的图片文件数组 | 文件数组（前端FormData） |

### GET /getImage/{name}
获取图片

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| name | String | 是 | 图片文件名 | image.jpg |

## UserController

**基础路径**: `/api/user`

### POST /login
微信小程序登录

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| request | LoginRequest | 是 | 登录请求对象 | 见下表 |

**LoginRequest对象字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| code | String | 是 | 微信登录code | wx_code_123456 |

**完整示例**:
```json
{
  "code": "wx_code_123456"
}
```

### GET /checkToken
检查token有效性

**参数**: 无

### POST /admin/user/updateStatus/{userId}
管理员更新用户状态

**参数**:

| 参数名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| userId | Integer | 是 | 用户ID | 1001 |
| request | Map<String, Integer> | 是 | 更新请求体 | 见下表 |

**Map字段**:

| 字段名 | 类型 | 必填 | 描述 | 示例 |
|--------|------|------|------|------|
| status | Integer | 是 | 用户状态 | 1 |

**完整示例**:
```json
{
  "status": 1
}
```