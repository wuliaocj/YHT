<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.OrderMapper">

    <resultMap id="OrderResultMap" type="com.example.demo.domain.Order">
        <id column="id" property="id"/>
        <result column="order_no" property="orderNo"/>
        <result column="user_id" property="userId"/>
        <result column="total_amount" property="totalAmount"/>
        <result column="discount_amount" property="discountAmount"/>
        <result column="delivery_fee" property="deliveryFee"/>
        <result column="actual_amount" property="actualAmount"/>
        <result column="payment_method" property="paymentMethod"/>
        <result column="payment_status" property="paymentStatus"/>
        <result column="payment_time" property="paymentTime"/>
        <result column="transaction_id" property="transactionId"/>
        <result column="order_status" property="orderStatus"/>
        <result column="order_type" property="orderType"/>
        <result column="take_code" property="takeCode"/>
        <result column="estimated_time" property="estimatedTime"/>
        <result column="complete_time" property="completeTime"/>
        <result column="cancel_reason" property="cancelReason"/>
        <result column="cancel_time" property="cancelTime"/>
        <result column="user_remark" property="userRemark"/>
        <result column="admin_remark" property="adminRemark"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
    </resultMap>

    <select id="selectById" resultMap="OrderResultMap">
        select * from `order` where id = #{id}
    </select>

    <select id="selectByOrderNo" resultMap="OrderResultMap">
        select * from `order` where order_no = #{orderNo}
    </select>

    <select id="selectByUserId" resultMap="OrderResultMap">
        select *
        from `order`
        where user_id = #{userId}
        order by create_time desc
    </select>

    <select id="selectAll" resultMap="OrderResultMap">
        select * from `order` order by create_time desc
    </select>

    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into `order`(order_no, user_id, total_amount, discount_amount, delivery_fee, actual_amount,
                            payment_method, payment_status, payment_time, transaction_id,
                            order_status, order_type, take_code, estimated_time,
                            complete_time, cancel_reason, cancel_time, user_remark, admin_remark)
        values (#{orderNo}, #{userId}, #{totalAmount}, #{discountAmount}, #{deliveryFee}, #{actualAmount},
                #{paymentMethod}, #{paymentStatus}, #{paymentTime}, #{transactionId},
                #{orderStatus}, #{orderType}, #{takeCode}, #{estimatedTime},
                #{completeTime}, #{cancelReason}, #{cancelTime}, #{userRemark}, #{adminRemark})
    </insert>

    <update id="update">
        update `order`
        set total_amount    = #{totalAmount},
            discount_amount = #{discountAmount},
            delivery_fee    = #{deliveryFee},
            actual_amount   = #{actualAmount},
            payment_method  = #{paymentMethod},
            payment_status  = #{paymentStatus},
            payment_time    = #{paymentTime},
            transaction_id  = #{transactionId},
            order_status    = #{orderStatus},
            order_type      = #{orderType},
            take_code       = #{takeCode},
            estimated_time  = #{estimatedTime},
            complete_time   = #{completeTime},
            cancel_reason   = #{cancelReason},
            cancel_time     = #{cancelTime},
            user_remark     = #{userRemark},
            admin_remark    = #{adminRemark}
        where id = #{id}
    </update>
</mapper>


